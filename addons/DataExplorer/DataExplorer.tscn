[gd_scene load_steps=2 format=2]

[sub_resource type="GDScript" id=1]
script/source = "tool
extends Tree

var plugin: EditorPlugin

var current_category: TreeItem

func _ready() -> void:
	refresh()

func refresh():
	create_item()
	
	add_category(\"Misc\")
	add_item(\"Main Menu\", \"res://Resources/Anarchy/Scenes/anarchy_main_menu.tscn\")
	add_item(\"Bug Report\", \"res://Resources/Anarchy/Scenes/UIElements/bug_reporting_tool.tscn\")
	
	add_category(\"Enemies\")
	
	var enemy_data = TextDatabase.load(\"res://Resources/Data/EnemyStorage.gd\", \"res://Resources/Data/Enemies.cfg\")
	for enemy in enemy_data.get_array():
		if enemy.is_swarm:
			continue
		add_item(enemy.name, enemy.scene)
	
	add_category(\"Swarms\")
	
	for enemy in enemy_data.get_array():
		if not enemy.is_swarm:
			continue
		add_item(enemy.name, enemy.scene)
	
	add_category(\"Workshops\")
	
	var building_data = TextDatabase.load(\"res://Resources/Data/BuildingStorage.gd\", \"res://Resources/Data/Buildings.cfg\")
	for building in building_data.get_array():
		if building.get(\"category\", \"\") != \"Workshop\":
			continue
		add_item(building.name, building.scene)
	
	add_category(\"Turrets\")
	
	for building in building_data.get_array():
		if not \"Turret\" in building.name:
			continue
		
		add_item(building.name, building.scene)

func add_category(category: String):
	current_category = create_item()
	current_category.set_text(0, category)

func add_item(item_name: String, path: String):
	var item = create_item(current_category)
	item.set_text(0, item_name)
	item.set_metadata(0, path)

func open_item() -> void:
	var item = get_selected()
	var meta = item.get_metadata(0)
	if meta:
		plugin.get_editor_interface().open_scene_from_path(meta)
"

[node name="DataExplorer" type="VBoxContainer"]
offset_right = 40.0
offset_bottom = 40.0

[node name="Button" type="Button" parent="."]
offset_right = 60.0
offset_bottom = 20.0
text = "Refresh"

[node name="Tree" type="Tree" parent="."]
offset_top = 24.0
offset_right = 60.0
offset_bottom = 40.0
size_flags_vertical = 3
hide_root = true
script = SubResource( 1 )

[connection signal="item_activated" from="Tree" to="Tree" method="open_item"]
