[gd_scene load_steps=5 format=2]

[ext_resource path="res://Nodes/Player/Pets/ShootingPetBlaster.png" type="Texture2D" id=2]
[ext_resource path="res://Nodes/Map/ZIndexer.tscn" type="PackedScene" id=5]

[sub_resource type="GDScript" id=1]
script/source = "extends \"res://Nodes/Player/Weapons/Ranged/PlayerBullet.gd\"

var life_time: float
var dead = false

func _ready() -> void:
	pass
	## TODO: sfx

func _physics_process(delta: float) -> void:
	if dead:
		return
	
	var ray := Utils.game.map.pixel_map.rayCastQTDistance(global_position,  dir, speed * delta, Player.get_weapon_mask(get_meta(\"data\")))
	if ray:
		life_time = 10
		dead = true
		global_position = ray.hit_position
	else:
		global_position += dir * speed * delta
	
	life_time += delta
	if life_time >= 0.3:
		queue_free()

func get_damage_data() -> Dictionary:
	return {damage = 10}
"

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 3, 2 )

[node name="ShootingPetBlaster" type="Area2D"]
z_index = 700
z_as_relative = false
script = SubResource( 1 )
speed = 500.0

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource( 2 )

[node name="ZIndexer" parent="." instance=ExtResource( 5 )]
z_index = 700

[node name="Sprite2D" type="Sprite2D" parent="."]
rotation = -3.14159
z_index = 700
z_as_relative = false
texture = ExtResource( 2 )
