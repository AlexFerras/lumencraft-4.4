[gd_scene load_steps=9 format=2]

[ext_resource path="res://Resources/Textures/light5.png" type="Texture2D" id=1]
[ext_resource path="res://Nodes/Lights/LightSprite.gd" type="Script" id=2]
[ext_resource path="res://Nodes/Player/Weapons/Icons/Dynamite_Icon_.png" type="Texture2D" id=3]
[ext_resource path="res://SFX/Weapons/beep_04.wav" type="AudioStream" id=4]

[sub_resource type="GDScript" id=30]
script/source = "extends \"res://Nodes/Player/Weapons/Throwable/ThrowableWeapon.gd\"

@onready var sprite := $Sprite2D as Sprite2D

@export var power: float = 0.5

#func _ready():
#	$Loop.stream.audio_stream = Utils.random_sound(\"res://SFX/Weapons/beep_04\")

func _physics_process(delta: float) -> void:
	sprite.rotation += linear_velocity.x * 0.1 * delta


func _on_Timer_timeout() -> void:
	$Loop.playing=false
	var explosion := Const.EXPLOSION.instantiate() as Node2D
	explosion.dmg=10
	explosion.scale = Vector2.ONE * power
	explosion.position = position
	get_parent().add_child(explosion)
	queue_free()
"

[sub_resource type="CircleShape2D" id=1]
radius = 2.0

[sub_resource type="Animation" id=27]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath("Loop:playing")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ false ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("Loop:pitch_scale")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ 2.0 ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("LightSprite:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Vector2( 0, 0 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("LightSprite:scale")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Vector2( 1, 1 ) ]
}
tracks/4/type = "value"
tracks/4/path = NodePath("Sprite2D:self_modulate")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 1 ) ]
}

[sub_resource type="Animation" id=29]
resource_name = "start"
length = 3.0
step = 0.05
tracks/0/type = "value"
tracks/0/path = NodePath("LightSprite:modulate:a")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0, 0.4, 0.6, 0.9, 1.1, 1.35, 1.5, 1.65, 1.8, 1.95, 2.05, 2.15, 2.25, 2.3, 2.4 ),
"transitions": PackedFloat32Array( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ),
"update": 0,
"values": [ 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0 ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("LightSprite:scale")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0, 0.4, 0.6, 0.9, 1.1, 1.35, 1.5, 1.65, 1.8, 1.95, 2.05, 2.15, 2.25, 2.3, 2.4 ),
"transitions": PackedFloat32Array( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ),
"update": 0,
"values": [ Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ), Vector2( 1e-05, 1e-05 ), Vector2( 0.5, 0.5 ) ]
}
tracks/2/type = "audio"
tracks/2/path = NodePath("Loop")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"clips": [ {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
}, {
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource( 4 )
} ],
"times": PackedFloat32Array( 0, 0.6, 1.1, 1.5, 1.8, 2.05, 2.25, 2.4 )
}

[node name="Dynamite" type="PixelMapRigidBody"]
gravity_scale = 0.0
radius = 3
pixel_map_bounce = 0.4
script = SubResource( 30 )

[node name="Timer" type="Timer" parent="."]
wait_time = 2.5
autostart = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource( 1 )

[node name="LightSprite" type="Node2D" parent="."]
modulate = Color( 2.00392, 0.239216, 0.219608, 1 )
script = ExtResource( 2 )
texture = ExtResource( 1 )

[node name="Loop" type="AudioStreamPlayer2D" parent="."]
stream = ExtResource( 4 )
volume_db = -15.0
pitch_scale = 2.0
max_distance = 500.0
attenuation = 2.0
bus = "SFX"

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
autoplay = "start"
anims/RESET = SubResource( 27 )
anims/start = SubResource( 29 )

[node name="Area2D" type="Area2D" parent="."]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Area2D"]
shape = SubResource( 1 )

[node name="Sprite2D" type="Sprite2D" parent="."]
scale = Vector2( 0.025, 0.025 )
texture = ExtResource( 3 )

[connection signal="timeout" from="Timer" to="." method="_on_Timer_timeout"]
