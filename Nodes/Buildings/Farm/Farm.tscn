[gd_scene load_steps=40 format=2]

[ext_resource path="res://Nodes/Lights/LightSprite.gd" type="Script" id=1]
[ext_resource path="res://Nodes/Lights/Textures/SmoothCircle.png" type="Texture2D" id=2]
[ext_resource path="res://Nodes/Buildings/Common/Computer/GenericComputer.tscn" type="PackedScene" id=3]
[ext_resource path="res://Nodes/Buildings/Farm/Shroomer.tscn" type="PackedScene" id=4]
[ext_resource path="res://Nodes/Buildings/Common/Computer/ComputerScreen.tscn" type="PackedScene" id=5]
[ext_resource path="res://Resources/Textures/lights_vfx/1.png" type="Texture2D" id=6]
[ext_resource path="res://Nodes/Buildings/Farm/Farm.png" type="Texture2D" id=7]
[ext_resource path="res://Nodes/Buildings/Farm/Wheel.png" type="Texture2D" id=8]
[ext_resource path="res://Nodes/Buildings/Farm/FarmMask.png" type="Texture2D" id=9]
[ext_resource path="res://Nodes/Buildings/Farm/FarmShadow.png" type="Texture2D" id=10]
[ext_resource path="res://Nodes/Map/ZIndexer.tscn" type="PackedScene" id=11]
[ext_resource path="res://Resources/Textures/lights_vfx/Lamp_light_Radial_main_T001.png" type="Texture2D" id=12]
[ext_resource path="res://Nodes/Buildings/Tower/Lamp_fog_main_2.png" type="Texture2D" id=13]
[ext_resource path="res://Nodes/Unique/FearBuilding.gd" type="Script" id=14]
[ext_resource path="res://Nodes/Buildings/Farm/mushroom_capacity_icon.png" type="Texture2D" id=15]
[ext_resource path="res://Nodes/Buildings/Farm/mushroom_grow_speed_icon.png" type="Texture2D" id=16]

[sub_resource type="GDScript" id=65]
script/source = "extends BaseBuilding

const MAX_SHROOMS = 4

@onready var pixel_map := Utils.game.map.pixel_map as PixelMap
@onready var timer := $GrowthTick as Timer
@onready var shroomer := $Sprite2D/Shroomer

var mushroom_count := 1
var speed := 0
var mushroom_more_lumens: bool

func _ready() -> void:
	add_to_group(\"lumen_farm\")
	update_speed()
	if hack:
		timer.stop()
	
	Utils.subscribe_tech(self, \"mushroom_more_lumens\")
	Utils.subscribe_tech(self, \"auto_farm\")
	
	if speed > 0 or mushroom_count > 1:
		$UpgradeComputer.call_deferred(\"reload\")
		$UpgradeComputer2.call_deferred(\"reload\")

func _tech_unlocked(tech: String):
	match tech:
		\"mushroom_more_lumens\":
			mushroom_more_lumens = true
			update_speed()
		\"auto_farm\":
			$AutoFarm.start()
		_:
			super._tech_unlocked(tech)

func build():
	super.build()
	
	if not timer:
		await self.ready
	timer.start()
	
	for i in mushroom_count:
		if shroomer.get_mushroom(i):
			Utils.explode_circle(shroomer.get_mushroom(i).global_position, 10, 5000, 10, 10,-1,false,0.0)

func grow_mushrooms() -> void:
	if not is_running:
		return
	
	for i in mushroom_count:
		var mushroom: Node2D = shroomer.get_mushroom(i)
		if mushroom:
			if mushroom.can_grow() and shroomer.can_grow_mushroom(i):
				mushroom.grow(3)
				mushroom.kicked_time = 0.8
				break
		elif shroomer.can_grow_mushroom(i):
			mushroom = instance_mushroom()
			shroomer.add_mushroom(i, mushroom)
			mushroom.grow(3,randf_range(0.1,0.2))
			break

func instance_mushroom() -> Node2D:
	var mushroom = preload(\"res://Nodes/Objects/Mushrooms/Mushroom.tscn\").instantiate()
	mushroom.set_as_top_level(true)
	if mushroom_more_lumens:
		mushroom.lumens_inside=10
	mushroom.global_scale= Vector2(0.01, 0.01)
	mushroom.random_growth = false
	mushroom.rotation = randf() * TAU
	return mushroom

func update_speed():
	timer.wait_time = (12 - speed * 1.5) 
	timer.start()

func progress_time(time: int):
	var count := time / timer.wait_time
	for i in count:
		grow_mushrooms()

func set_disabled(disabled: bool, force := false):
	if disabled:
		$Sprite2D/LightsAnimator.play(\"PowerOFF\")
	else:
		$Sprite2D/LightsAnimator.play(\"PowerON\")
	if force:
		$Sprite2D/LightsAnimator.advance(99999)
	super.set_disabled(disabled, force)
	$Sprite2D/LightSprite.visible = not disabled
	$Sprite2D/LightSprite.dirty = true
	if disabled:
		$Sprite2D/Sprite2/AnimationPlayer.stop()
	else:
		$Sprite2D/Sprite2/AnimationPlayer.play()
	
	$UpgradeComputer.set_power_disabled(disabled)
	$UpgradeComputer2.set_power_disabled(disabled)
	
	if disabled:
		timer.stop()
	else:
		timer.start()

func _get_save_data() -> Dictionary:
	var data := Save.get_properties(self, [\"mushroom_count\", \"speed\"])
	
	for spot in shroomer.get_children():
		if spot.get_child_count() > 0:
			data[str(\"_mushroom_\", spot.get_index())] = spot.get_child(0).scale
	
	return data

func _set_save_data(data: Dictionary):
	Save.set_properties(self, data)
	
	if not shroomer:
		await self.ready
	
	for index in data:
		if not index.begins_with(\"_mushroom\"):
			continue
		
		var mushroom = instance_mushroom()
		shroomer.add_mushroom(int(index), mushroom)
		mushroom.scale = data[index]
	
	$UpgradeComputer.reload()
	$UpgradeComputer2.reload()

func auto_harvest() -> void:
	for i in MAX_SHROOMS:
		var mushroom = shroomer.get_mushroom(i)
		if mushroom:
			mushroom.destroy({})
"

[sub_resource type="RectangleShape2D" id=66]
extents = Vector2( 21.1009, 27.6795 )

[sub_resource type="Animation" id=83]
resource_name = "PowerOFF"
length = 5.0
tracks/0/type = "value"
tracks/0/path = NodePath("LightSprite:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 5 ),
"transitions": PackedFloat32Array( 2 ),
"update": 3,
"values": [ Color( 0.878431, 1.12941, 1.59608, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("LightSprite:is_static")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0, 5 ),
"transitions": PackedFloat32Array( 1, 1 ),
"update": 1,
"values": [ false, true ]
}

[sub_resource type="Animation" id=84]
resource_name = "PowerON"
length = 3.0
tracks/0/type = "value"
tracks/0/path = NodePath("LightSprite:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 0.5 ),
"update": 3,
"values": [ Color( 0.878431, 1.12941, 1.59608, 0.588235 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("LightSprite:is_static")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0, 3 ),
"transitions": PackedFloat32Array( 1, 1 ),
"update": 1,
"values": [ false, true ]
}

[sub_resource type="Animation" id=85]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath("LightSprite:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 0.878431, 1.12941, 1.59608, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("LightSprite:is_static")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ true ]
}

[sub_resource type="Animation" id=67]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ 0 ]
}

[sub_resource type="Animation" id=14]
resource_name = "Rotat"
length = 12.0
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9, 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9, 10, 10.1, 10.2, 10.3, 10.4, 10.5, 10.6, 10.7, 10.8, 10.9, 11, 11.1, 11.2, 11.3, 11.4, 11.5, 11.6, 11.7, 11.8, 11.9 ),
"transitions": PackedFloat32Array( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ),
"update": 1,
"values": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119 ]
}

[sub_resource type="GDScript" id=11]
script/source = "extends \"res://Nodes/Buildings/Farm/UpgradeComputer.gd\"

func do_upgrade():
	farm.mushroom_count += 1

func get_level() -> int:
	return farm.mushroom_count - 1

func is_max() -> bool:
	return farm.mushroom_count >= farm.MAX_SHROOMS
"

[sub_resource type="GDScript" id=68]
script/source = "extends \"res://Nodes/Buildings/Farm/UpgradeComputer.gd\"

func do_upgrade():
	farm.speed += 1
	farm.update_speed()

func get_level() -> int:
	return farm.speed

func is_max() -> bool:
	return farm.speed >= 4
"

[sub_resource type="Animation" id=81]
resource_name = "AlarmLOOP"
length = 3.0
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath("../LightSprite2:is_static")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 1,
"values": [ false ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("../LightSprite2:scale")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0, 1.1, 3 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 0,
"values": [ Vector2( 0.337, 0.365 ), Vector2( 0.337, 0.438 ), Vector2( 0.337, 0.365 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("../LightSprite2:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PackedFloat32Array( 0, 1.1, 3 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 0,
"values": [ Color( 1, 0, 0, 1 ), Color( 0.0196078, 0.4, 1, 1 ), Color( 1, 0, 0, 1 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("../../Sprite2D/LightSprite:is_static")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 1,
"values": [ false ]
}
tracks/4/type = "value"
tracks/4/path = NodePath("../../Sprite2D/LightSprite:modulate")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"times": PackedFloat32Array( 0.8 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 0.431373, 0.427451, 0.666667, 1 ) ]
}

[sub_resource type="Animation" id=82]
resource_name = "AlarmON"
length = 3.0
tracks/0/type = "value"
tracks/0/path = NodePath("../LightSprite2:is_static")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 1,
"values": [ false ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("../LightSprite2:scale")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0.8, 2, 3 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 3,
"values": [ Vector2( 0.337, 0.365 ), Vector2( 0.337, 0.445 ), Vector2( 0.337, 0.365 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("../LightSprite2:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PackedFloat32Array( 0.8, 2, 3 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 3,
"values": [ Color( 1, 0, 0, 1 ), Color( 0.0196078, 0.4, 1, 1 ), Color( 1, 0, 0, 1 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("../../Sprite2D/LightSprite:modulate")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PackedFloat32Array( 0.8 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 0.670588, 0.482353, 0.454902, 0.843137 ) ]
}
tracks/4/type = "value"
tracks/4/path = NodePath("../../Sprite2D/LightSprite:is_static")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"times": PackedFloat32Array( 0.1 ),
"transitions": PackedFloat32Array( 1 ),
"update": 1,
"values": [ false ]
}

[sub_resource type="Animation" id=79]
resource_name = "Blinks"
length = 1.91
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0, 1, 1.9 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 0,
"values": [ Color( 0.87451, 0.560784, 1, 0.235294 ), Color( 0.831373, 0.772549, 0.968627, 0.0784314 ), Color( 0.87451, 0.560784, 1, 0.235294 ) ]
}
tracks/1/type = "animation"
tracks/1/path = NodePath("../Building_Light_Spot4/AnimationPlayer")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"clips": PackedStringArray( "Blink" ),
"times": PackedFloat32Array( 0 )
}
tracks/2/type = "animation"
tracks/2/path = NodePath("../Building_Light_Spot3/AnimationPlayer")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"clips": PackedStringArray( "Blink" ),
"times": PackedFloat32Array( 0 )
}

[sub_resource type="Animation" id=80]
resource_name = "PowerOFF"
length = 3.0
tracks/0/type = "value"
tracks/0/path = NodePath("../../Sprite2D/LightSprite:is_static")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0, 3 ),
"transitions": PackedFloat32Array( 1, 1 ),
"update": 1,
"values": [ false, true ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("../../Sprite2D/LightSprite:modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 1, 1, 1, 0 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("../LightSprite2:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 2.1098, 1.98039, 1.43529, 0 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("../LightSprite2:is_static")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PackedFloat32Array( 0, 3 ),
"transitions": PackedFloat32Array( 1, 1 ),
"update": 1,
"values": [ false, true ]
}
tracks/4/type = "animation"
tracks/4/path = NodePath("../Building_Light_Spot4/AnimationPlayer")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"clips": PackedStringArray( "Power_OFF" ),
"times": PackedFloat32Array( 0 )
}
tracks/5/type = "animation"
tracks/5/path = NodePath("../Building_Light_Spot3/AnimationPlayer")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/keys = {
"clips": PackedStringArray( "Power_OFF" ),
"times": PackedFloat32Array( 0 )
}
tracks/6/type = "value"
tracks/6/path = NodePath(".:modulate")
tracks/6/interp = 1
tracks/6/loop_wrap = true
tracks/6/imported = false
tracks/6/enabled = true
tracks/6/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 1.86275, 1, 0.290196, 0 ) ]
}

[sub_resource type="Animation" id=75]
resource_name = "PowerON"
length = 3.0
tracks/0/type = "value"
tracks/0/path = NodePath("../../Sprite2D/LightSprite:is_static")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 1,
"values": [ true ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("../../Sprite2D/LightSprite:modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 1, 1, 1, 1 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("../LightSprite2:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 2.1098, 1.98039, 1.43529, 1 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("../LightSprite2:is_static")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PackedFloat32Array( 0, 3 ),
"transitions": PackedFloat32Array( 1, 1 ),
"update": 1,
"values": [ false, true ]
}
tracks/4/type = "animation"
tracks/4/path = NodePath("../Building_Light_Spot4/AnimationPlayer")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"clips": PackedStringArray( "Power_ON" ),
"times": PackedFloat32Array( 0 )
}
tracks/5/type = "animation"
tracks/5/path = NodePath("../Building_Light_Spot3/AnimationPlayer")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/keys = {
"clips": PackedStringArray( "Power_ON" ),
"times": PackedFloat32Array( 0 )
}
tracks/6/type = "value"
tracks/6/path = NodePath(".:modulate")
tracks/6/interp = 1
tracks/6/loop_wrap = true
tracks/6/imported = false
tracks/6/enabled = true
tracks/6/keys = {
"times": PackedFloat32Array( 3 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 0.87451, 0.560784, 1, 0.235294 ) ]
}

[sub_resource type="Animation" id=76]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath("../LightSprite2:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 2.1098, 1.98039, 1.43529, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("../LightSprite2:is_static")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ true ]
}
tracks/2/type = "value"
tracks/2/path = NodePath(".:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 1.86275, 1, 0.290196, 0 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("../LightSprite2:scale")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Vector2( 0.336564, 0.430377 ) ]
}
tracks/4/type = "value"
tracks/4/path = NodePath("../../Sprite2D/LightSprite:is_static")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ true ]
}
tracks/5/type = "value"
tracks/5/path = NodePath("../../Sprite2D/LightSprite:modulate")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 0 ) ]
}

[sub_resource type="Animation" id=69]
resource_name = "Blink"
length = 1.921
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0, 1, 1.9 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 0,
"values": [ Color( 0.729412, 0.764706, 0.596078, 0.313726 ), Color( 0.729412, 0.764706, 0.596078, 0.196078 ), Color( 0.729412, 0.764706, 0.596078, 0.313726 ) ]
}

[sub_resource type="Animation" id=77]
resource_name = "Power_OFF"
length = 2.168
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 2.1 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 0.729412, 0.764706, 0.596078, 0 ) ]
}

[sub_resource type="Animation" id=70]
resource_name = "Power_ON"
length = 2.168
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0.6, 0.9, 2.1 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 3,
"values": [ Color( 0.807843, 1, 0.486275, 0.243137 ), Color( 0.807843, 1, 0.486275, 0.109804 ), Color( 0.729412, 0.764706, 0.596078, 0.313726 ) ]
}

[sub_resource type="Animation" id=71]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 0.807843, 1, 0.486275, 0 ) ]
}

[sub_resource type="Animation" id=72]
resource_name = "Blink"
length = 1.921
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0, 1, 1.9 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 0,
"values": [ Color( 0.729412, 0.764706, 0.596078, 0.313726 ), Color( 0.729412, 0.764706, 0.596078, 0.196078 ), Color( 0.729412, 0.764706, 0.596078, 0.313726 ) ]
}

[sub_resource type="Animation" id=78]
resource_name = "Power_OFF"
length = 2.168
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 2.1 ),
"transitions": PackedFloat32Array( 1 ),
"update": 3,
"values": [ Color( 0.729412, 0.764706, 0.596078, 0 ) ]
}

[sub_resource type="Animation" id=73]
resource_name = "Power_ON"
length = 2.168
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0.6, 0.9, 2.1 ),
"transitions": PackedFloat32Array( 1, 1, 1 ),
"update": 3,
"values": [ Color( 0.807843, 1, 0.486275, 0.245098 ), Color( 0.807843, 1, 0.486275, 0.109804 ), Color( 0.729412, 0.764706, 0.596078, 0.313726 ) ]
}

[sub_resource type="Animation" id=74]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0 ),
"transitions": PackedFloat32Array( 1 ),
"update": 0,
"values": [ Color( 0.807843, 1, 0.486275, 0 ) ]
}

[node name="Farm" type="Area2D" groups=["timed_nodes"]]
z_index = 600
z_as_relative = false
script = SubResource( 65 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2( -21.7676, -5.07831 )
shape = SubResource( 66 )

[node name="Sprite2D" type="Sprite2D" parent="."]
position = Vector2( -16.1996, -4.79966 )
rotation = 1.57079
scale = Vector2( 0.1, 0.1 )
z_index = 2
texture = ExtResource( 7 )

[node name="LightsAnimator" type="AnimationPlayer" parent="Sprite2D"]
anims/PowerOFF = SubResource( 83 )
anims/PowerON = SubResource( 84 )
anims/RESET = SubResource( 85 )

[node name="LightSprite" type="Node2D" parent="Sprite2D"]
modulate = Color( 1, 1, 1, 0 )
position = Vector2( 3.9502, 39.4536 )
scale = Vector2( -0.452691, 0.426731 )
script = ExtResource( 1 )
texture = ExtResource( 2 )
is_static = true

[node name="Shadow" type="Sprite2D" parent="Sprite2D"]
position = Vector2( 21.7674, -83.663 )
rotation = -1.57079
scale = Vector2( 4.9, 4.9 )
z_index = 2
z_as_relative = false
texture = ExtResource( 10 )

[node name="Shroomer" parent="Sprite2D" instance=ExtResource( 4 )]
position = Vector2( 25, -315 )
z_index = 2
z_as_relative = false

[node name="Sprite2" type="Sprite2D" parent="Sprite2D"]
position = Vector2( -85, -35 )
texture = ExtResource( 8 )
hframes = 8
vframes = 15

[node name="AnimationPlayer" type="AnimationPlayer" parent="Sprite2D/Sprite2"]
autoplay = "Rotat"
playback_speed = 4.0
anims/RESET = SubResource( 67 )
anims/Rotat = SubResource( 14 )

[node name="VisibleOnScreenEnabler2D" type="VisibleOnScreenEnabler2D" parent="Sprite2D/Sprite2"]
position = Vector2( -205, -65 )
rect = Rect2( 0, 0, 415, 125 )

[node name="GrowthTick" type="Timer" parent="."]
wait_time = 0.5

[node name="AutoFarm" type="Timer" parent="."]
wait_time = 300.0

[node name="UpgradeComputer" parent="." instance=ExtResource( 3 )]
position = Vector2( -34, 26.63 )
scale = Vector2( 0.5, 0.5 )
script = SubResource( 11 )
target_screen = NodePath("../ComputerScreen")
display_icon = ExtResource( 15 )
upgrade = "Upgrade Capacity"
description = "More mushrooms will grow at once."
prices = [ 50, 100, 150, 200 ]

[node name="UpgradeComputer2" parent="." instance=ExtResource( 3 )]
position = Vector2( -11.58, 26.685 )
scale = Vector2( 0.5, 0.5 )
script = SubResource( 68 )
target_screen = NodePath("../ComputerScreen")
display_icon = ExtResource( 16 )
upgrade = "Upgrade Speed"
description = "Mushrooms will grow faster."
prices = [ 50, 100, 150, 200 ]

[node name="ComputerScreen" parent="." instance=ExtResource( 5 )]
position = Vector2( 0, 21 )

[node name="PreferredSize" type="ReferenceRect" parent="ComputerScreen"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -450.0
offset_top = -640.0
offset_right = 450.0

[node name="TerrainMask" type="Sprite2D" parent="."]
visible = false
position = Vector2( -20.6829, -0.824959 )
scale = Vector2( 0.1, 0.1 )
texture = ExtResource( 9 )

[node name="ZIndexer" parent="." instance=ExtResource( 11 )]
z_index = 600

[node name="Socket" type="Marker2D" parent="."]
position = Vector2( -38.1073, -28.4915 )
scale = Vector2( 0.25, 0.25 )

[node name="FearBuilding" type="Node2D" parent="."]
script = ExtResource( 14 )
primary_animator = NodePath("../Sprite2D/LightsAnimator")
secondary_animator = NodePath("Light_System_Anim")

[node name="Light_System_Anim" type="AnimationPlayer" parent="FearBuilding"]
root_node = NodePath("../LampaHalo2")
anims/AlarmLOOP = SubResource( 81 )
anims/AlarmON = SubResource( 82 )
anims/Blinks = SubResource( 79 )
anims/PowerOFF = SubResource( 80 )
anims/PowerON = SubResource( 75 )
anims/RESET = SubResource( 76 )
next/AlarmON = "Alarm_Lights_Blinks"
next/PowerOFF = "Blinks"
next/PowerON = "Blinks"

[node name="LampaHalo2" type="Sprite2D" parent="FearBuilding"]
modulate = Color( 1.86275, 1, 0.290196, 0 )
self_modulate = Color( 1.79, 1.91, 1.32, 1 )
position = Vector2( 50, -3 )
rotation = 0.0373647
scale = Vector2( 1.63958, 1.49444 )
z_index = -2
texture = ExtResource( 13 )

[node name="Building_Light_Spot3" type="Sprite2D" parent="FearBuilding"]
modulate = Color( 0.807843, 1, 0.486275, 0 )
self_modulate = Color( 1.79, 1.91, 1.32, 1 )
position = Vector2( -37, -14 )
rotation = -1.586
scale = Vector2( 0.100072, -0.0819399 )
z_index = 35
texture = ExtResource( 6 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="FearBuilding/Building_Light_Spot3"]
anims/Blink = SubResource( 69 )
anims/Power_OFF = SubResource( 77 )
anims/Power_ON = SubResource( 70 )
anims/RESET = SubResource( 71 )
next/Power_ON = "Blink"

[node name="Building_Light_Spot4" type="Sprite2D" parent="FearBuilding"]
modulate = Color( 0.807843, 1, 0.486275, 0 )
self_modulate = Color( 1.79, 1.91, 1.32, 1 )
position = Vector2( -25, 40 )
rotation = 3.13897
scale = Vector2( 0.138985, -0.0848215 )
z_index = 35
texture = ExtResource( 6 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="FearBuilding/Building_Light_Spot4"]
autoplay = "Blink"
anims/Blink = SubResource( 72 )
anims/Power_OFF = SubResource( 78 )
anims/Power_ON = SubResource( 73 )
anims/RESET = SubResource( 74 )
next/Power_ON = "Blink"

[node name="LightSprite2" type="Node2D" parent="FearBuilding"]
modulate = Color( 2.1098, 1.98039, 1.43529, 0 )
position = Vector2( -9, 2.38419e-07 )
rotation = 3.11901
scale = Vector2( 0.336564, 0.430377 )
script = ExtResource( 1 )
texture = ExtResource( 12 )
follow_rotation = true
is_static = true

[connection signal="timeout" from="GrowthTick" to="." method="grow_mushrooms"]
[connection signal="timeout" from="AutoFarm" to="." method="auto_harvest"]
